<%- include('../partials/header')%>
<h2><a href="/bands/edit/<%=band._id%>">Edit Member</a></h2>
<section id="show">
    <div><h4>Name: </h4></div>
    <div><h6><%= band.name %></h6></div><br>
    <div><h4>Role: </h4></div>
    <div><h6><%= band.role %></h6></div><br>
    <div><h4>Playing: </h4></div>
    <div><h6><%=band.playing ? 'Yes' : 'No'%></h6></div><br>
    <div><h4>Date Joined: </h4></div>
    <div><h6><%=band.joined.toDateString()%></h6></div><br>
    <div><h4>Music Abilities: </h4></div>
    <%= band.musicskill.map(i => i).join(', ') %>
  </section>
  <h4>Review of Member</h4>
  <form id="add-review-form" method="POST" action="/bands/<%=band._id%>/reviews">
  <textarea name="content"></textarea>
  <label>Review: </label>
  <select name="rating" class="browser-default">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
  </select>
  <input type="submit" value="Add Review">
  </form>
<br><br>
  <% if (band.reviews.length) { %>
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Review</th>
          <th>Rating</th>
        </tr>
      </thead>
      <tbody>
        <% var total = 0 %>
        <% band.reviews.forEach(function(r) { %>
          <% total += r.rating %>
          <tr>
            <td><%= r.createdAt.toLocaleDateString() %></td>
            <td><%= r.content %></td>
            <td><%= r.rating %></td>
          </tr>
          <th>Comments
            <form id="add-comment-form" method="POST" action="/bands/<%=band._id%>/reviews/<%=r._id%>/comments">
              <input type="text" name="reviewComment">  
              <input type="submit" value="Add Comment"> 
              </form>      
            </th>
          <% }); %>
          <tr>
            <td colspan="2"></td>
            <td><strong><%= (total / band.reviews.length).toFixed(1) %></strong></td>
          </tr>
      </tbody>
    </table>
  <% } else { %>
    <h4>No Reviews Yet!</h4>
  <%}%>